<table mat-table [dataSource]="gists">
  <ng-container matColumnDef="owner">
    <th mat-header-cell *matHeaderCellDef class="ownerCol">Name</th>
    <td mat-cell *matCellDef="let gist" class="ownerCol">
      <span class="owner">
        <img [src]="gist.owner?.avatar_url" alt="avatar" />
        <p class="ellipsis" [matTooltip]="gist.owner?.login">
          {{ gist.owner?.login }}
        </p>
      </span>
    </td>
  </ng-container>

  <ng-container matColumnDef="filename">
    <th mat-header-cell *matHeaderCellDef class="filenameCol">Filename</th>
    <td mat-cell *matCellDef="let gist" class="filenameCol">
      <p class="ellipsis" [matTooltip]="getGistName(gist)">
        {{ getGistName(gist) }}
      </p>
    </td>
  </ng-container>

  <ng-container matColumnDef="fileCount">
    <th mat-header-cell *matHeaderCellDef class="fileCountCol">File Count</th>
    <td mat-cell *matCellDef="let gist" class="fileCountCol">
      {{ gist.files ? (gist.files | keyvalue).length : 0 }}
    </td>
  </ng-container>

  <ng-container matColumnDef="updatedAt">
    <th mat-header-cell *matHeaderCellDef class="updatedAtCol">Updated At</th>
    <td mat-cell *matCellDef="let gist" class="updatedAtCol">
      {{ gist.updated_at | timeAgo }}
    </td>
  </ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef class="actionsCol"></th>
    <td mat-cell *matCellDef="let gist" class="actionsCol">
      @if (isLoggedIn) {
      <div class="actions">
        <button
          mat-icon-button
          (click)="fork.emit(gist.id); $event.stopPropagation()"
        >
          <img src="images/fork.svg" alt="Fork Icon" />
        </button>
        <button
          mat-icon-button
          (click)="star.emit(gist.id); $event.stopPropagation()"
        >
          <img src="images/star.svg" alt="Star Icon" />
        </button>
      </div>
      }
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr
    mat-row
    *matRowDef="let gist; columns: displayedColumns"
    (click)="gistClick.emit(gist)"
  ></tr>
</table>
